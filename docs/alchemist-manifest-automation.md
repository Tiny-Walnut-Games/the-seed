# 🧪 Alchemist Manifest Automation

## Overview

The Alchemist Manifest Scaffold system automatically generates experiment manifests when Gu Pot issues are labeled as 'distilled'. This automation bridge between narrative development and experimental validation in the Alchemist Faculty framework.

## 🎯 How It Works

### Trigger Event
- **Event**: Issues labeled with any label containing 'distilled'
- **Target**: Gu Pot issues ready for experimental distillation
- **Examples**: `gu-pot:distilled`, `distilled`, `ready-for-distillation`

### Automated Process
1. **Detection**: GitHub Action detects when an issue receives a 'distilled' label
2. **Manifest Generation**: Uses `scripts/alchemist-faculty/generate_manifest.py` to create experiment manifest
3. **File Storage**: Saves manifest as `experiments/gu_pot/issue-<number>/manifest_v1.yaml`
4. **Repository Update**: Commits and pushes the generated manifest files
5. **Notification**: Posts informative comment on the issue with manifest links

## 📁 Generated Files

### Directory Structure
```
experiments/
└── gu_pot/
    └── issue-<number>/
        └── manifest_v1.yaml
```

### Manifest Contents
The generated manifest includes:
- **Metadata**: Experiment identification and creation details
- **Origin Binding**: Traceability links to the source Gu Pot issue
- **Experimental Context**: Hypothesis, metrics, and execution configuration
- **Validation Criteria**: Requirements for evidence evaluation and promotion
- **Integration Settings**: GitHub and Chronicle integration configuration

## 🔧 Manual Override

If automatic generation fails or you need to generate manifests manually:

```bash
# Generate manifest for a specific issue
python3 scripts/alchemist-faculty/generate_manifest.py \
  --issue-url https://github.com/owner/repo/issues/123 \
  --output experiments/gu_pot/issue-123 \
  --format yaml \
  --github-token $GITHUB_TOKEN

# Dry run (preview without saving)
python3 scripts/alchemist-faculty/generate_manifest.py \
  --issue-url https://github.com/owner/repo/issues/123 \
  --dry-run \
  --verbose
```

## 🛡️ Security Features

- **SHA-pinned Actions**: All GitHub Actions use specific SHA commits for supply chain security
- **Token Scope**: Uses minimal `GITHUB_TOKEN` permissions for API access
- **Concurrency Control**: Prevents conflicts when multiple issues are labeled simultaneously
- **Error Handling**: Provides helpful error messages and debugging guidance

## 🎭 Issue Comment Examples

### Success Comment
When manifest generation succeeds, the action posts:
```markdown
🧪 **Alchemist Faculty Manifest Generated**

Your Gu Pot issue has been labeled as **distilled** and an experiment manifest has been automatically generated!

📁 **Manifest Location**: `experiments/gu_pot/issue-123/manifest_v1.yaml`
🔗 **View Manifest**: [manifest_v1.yaml](../blob/main/experiments/gu_pot/issue-123/manifest_v1.yaml)

The manifest includes:
- 🎯 Experimental context and hypothesis  
- 🔗 Origin binding to this issue
- 📊 Validation criteria for evidence evaluation
- ⚙️ Execution configuration for reproducible experiments

**Next Steps:**
- Review the generated manifest for accuracy
- Execute the experiment using Alchemist Faculty tools  
- Update this issue with experimental evidence
- Progress to validation and promotion stages

*Generated by Alchemist Faculty Bot 🧙‍♂️*
```

### Error Comment
When generation fails, the action posts debugging guidance:
```markdown
❌ **Alchemist Manifest Generation Failed**

There was an error generating the experiment manifest for this issue.

**Possible causes:**
- Issue does not contain valid Gu Pot structure
- GitHub API access issues  
- Python script execution errors

**Manual Generation:**
You can manually generate the manifest using:
```bash
python3 scripts/alchemist-faculty/generate_manifest.py \
  --issue-url https://github.com/owner/repo/issues/123 \
  --output experiments/gu_pot/issue-123 \
  --format yaml
```

Please check the workflow logs for detailed error information.

*Alchemist Faculty Bot 🧙‍♂️*
```

## 🔮 Future Enhancements

- **Batch Processing**: Support for processing multiple issues simultaneously
- **Validation Integration**: Automatic execution of generated experiments  
- **Evidence Linkback**: Update issues with experimental results
- **Stage Progression**: Automatic label management based on experiment outcomes
- **Quality Metrics**: Track success rates and manifest quality scores

## 🧙‍♂️ Troubleshooting

### Common Issues

**Workflow doesn't trigger:**
- Verify the label name contains 'distilled'
- Check repository permissions for GitHub Actions
- Ensure the workflow file syntax is valid

**Manifest generation fails:**
- Verify issue contains proper Gu Pot structure (logline, tension, etc.)
- Check GitHub token permissions
- Review workflow logs for specific error messages

**Permission errors:**
- Ensure repository has Actions enabled
- Verify GITHUB_TOKEN has sufficient permissions
- Check branch protection rules aren't blocking commits

### Debug Mode
Enable verbose logging by checking the workflow run logs in the Actions tab.

---

*"Great automation is like a skilled alchemist - it transforms raw narrative into structured experimentation with precision and care."* 🧪✨